#include "thingProperties.h"
#include <EmonLib.h> 

EnergyMonitor emon1;

unsigned long lastSend = 0;
const long intervalo = 1000; 
double energiaAcumulada = 0; 

void setup() {
  Serial.begin(115200);
  delay(1500);

  emon1.current(32, 2.79);

  initProperties();

  ArduinoCloud.begin(ArduinoIoTPreferredConnection);

  setDebugMessageLevel(2);
  ArduinoCloud.printDebugInfo();
}

void loop() {
  ArduinoCloud.update();

  if (millis() - lastSend > intervalo) {
    double Irms = emon1.calcIrms(1480);
    corrente = Irms;
    Serial.print("Corrente (Irms): ");
    Serial.print(Irms, 3);
    Serial.println(" A");

    lastSend = millis();
  }
}

void onCorrenteChange() {
}
